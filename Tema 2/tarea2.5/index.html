
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://a23lupual.org/a23lupual/Tema%202/tarea2.5/">
      
      
        <link rel="prev" href="../tarea2.4/">
      
      
        <link rel="next" href="../tarea_ampliacion/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Practica 2.5 - Proxy inverso y balanceo de carga con SSL en NGINX - a23lupual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-25-proxy-inverso-y-balanceo-de-carga-con-ssl-en-nginx" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="a23lupual" class="md-header__button md-logo" aria-label="a23lupual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            a23lupual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Practica 2.5 - Proxy inverso y balanceo de carga con SSL en NGINX
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_2">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="a23lupual" class="md-nav__button md-logo" aria-label="a23lupual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    a23lupual
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ¬°Bienvenido! üéâ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema 2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tema 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SERVIDOR NGINX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarea2.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pr√°ctica 2.2 ‚Äì Autenticaci√≥n en Nginx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarea2.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PROXY INVERSO CON NGINX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarea2.4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BALANCEO DE CARGA CON PROXY INVERSO EN NGINX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Practica 2.5 - Proxy inverso y balanceo de carga con SSL en NGINX
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Practica 2.5 - Proxy inverso y balanceo de carga con SSL en NGINX
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducci√≥n
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificados" class="md-nav__link">
    <span class="md-ellipsis">
      Certificados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Tarea
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tarea">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cracion-del-certificado-autofirmado" class="md-nav__link">
    <span class="md-ellipsis">
      Craci√≥n del certificado autofirmado
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-ssl-del-servidor-proxy-inverso" class="md-nav__link">
    <span class="md-ellipsis">
      Configuraci√≥n SSL del servidor proxy inverso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobaciones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuestiones-finales" class="md-nav__link">
    <span class="md-ellipsis">
      Cuestiones finales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuestiones finales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cuestion-1" class="md-nav__link">
    <span class="md-ellipsis">
      Cuesti√≥n 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cuestion-2" class="md-nav__link">
    <span class="md-ellipsis">
      Cuesti√≥n 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarea_ampliacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuraci√≥n de un servidor Nginx con Hosts Virtuales y directorios de usuario
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema 3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tema 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%203/tarea3.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PRACTICA 3.1.- INSTALACI√ìN DE TOMCAT Y MAVEN PARA DESPLIEGUE DE APLICACI√ìN JAVA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%203/tarea3.2.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practica 3.4: Despliegue de una aplicacion React en Netlify
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%203/tarea3.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practica 3.2: Despliegue de aplicaciones con Node Express
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%203/tarea3.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tarea 3.5: Despliegue de una aplicaci√≥n Flask (Python)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema 4
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tema 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%204/tarea4.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Servidor DNS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema 5
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tema 5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tema%205/Tarea5.1_Git_GitHub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ejercicios Git y GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema 6
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tema 6
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tema%206/practica_6.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pr√°ctica 6.1 - Dockerizaci√≥n del despliegue de una aplicaci√≥n Node.js
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tema%206/practica_6.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pr√°ctica 6.2 - Despliegue de una aplicaci√≥n PHP con Nginx y MySQL usando Docker y docker-compose
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tema%206/practica_6.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pr√°ctica 6.3 - Despliegue de servidores web con usuarios autenticados mediante LDAP usando Docker y docker-compose
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducci√≥n
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificados" class="md-nav__link">
    <span class="md-ellipsis">
      Certificados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Tarea
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tarea">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cracion-del-certificado-autofirmado" class="md-nav__link">
    <span class="md-ellipsis">
      Craci√≥n del certificado autofirmado
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-ssl-del-servidor-proxy-inverso" class="md-nav__link">
    <span class="md-ellipsis">
      Configuraci√≥n SSL del servidor proxy inverso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobaciones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuestiones-finales" class="md-nav__link">
    <span class="md-ellipsis">
      Cuestiones finales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuestiones finales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cuestion-1" class="md-nav__link">
    <span class="md-ellipsis">
      Cuesti√≥n 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cuestion-2" class="md-nav__link">
    <span class="md-ellipsis">
      Cuesti√≥n 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="practica-25-proxy-inverso-y-balanceo-de-carga-con-ssl-en-nginx">Practica 2.5 - Proxy inverso y balanceo de carga con SSL en NGINX</h1>
<h2 id="introduccion">Introducci√≥n</h2>
<p>Teniendo en cuenta en el escenario en el que nos encontramos, ahora mismo los propios servidores web lo cual aumenta la carga que tienen que tienen que soportar, para esto vamos a trasladar el cifrado el servidor proxy, se puede pensar que la comunicaci√≥n entre el proxy y el servidor web puede ser insegura, pero esta comunicaci√≥n se lleva a cabo en una red privada, lo cual la protege de cualquier ataque.</p>
<h2 id="certificados">Certificados</h2>
<p>HTTPS se basa en el uso de certificados digitales, que resumiendo al entrar en una web se nos entrega un certificado mostrando quien es la p√°gina. </p>
<p>Para comprobar dichos certificados deberemos acceder a la Autoridad de Certificaci√≥n (CA). Los navegadores tienen precargadas las Autoridades de certificaci√≥n en las que conf√≠an, por lo tanto si una web usa una diferentes a estas nos aparecer√° un error diciendo que esta p√°gina no es segura.</p>
<h2 id="tarea">Tarea</h2>
<p>Partiendo de la configuraci√≥n exacta de la pr√°ctica anterior, en donde ten√≠amos el servidor proxy de balanceo de carga y los dos servidores web.</p>
<p>Deberemos a√±adir la configuraci√≥n SSL para el cifrado del proxy inverso, para cualquier solicitud distinta a los servidores web.</p>
<h3 id="cracion-del-certificado-autofirmado">Craci√≥n del certificado autofirmado</h3>
<p>Nosotros no usaremos certificados de ninguna CA de confianza, ya que:</p>
<ul>
<li>Nuestra p√°gina no est√° publicada en internet.</li>
<li>Y estos certificados son de pago.</li>
</ul>
<p>As√≠ que, crearemos nuestro propio certificado y lo firmaremos nosotros mismo como si fu√©semos una CA aut√©ntica.</p>
<p>Veamos, pues el proceso para generar los certificados y las claves asociadas a ellos (privada/p√∫blica). En primer lugar, debemos crear el siguiente directorio:
<code>/etc/nginx/ssl</code>.</p>
<p>Podemos crear los certificados con el siguiente comando:</p>
<p><img alt="'Creaci√≥n de certificados'" src="../../assets/imagenes/fotos2.5/openssl.png" /></p>
<ul>
<li><code>opnessl</code>: Es una herramienta por l√≠nea de comandos, que permite administras certificados, clave y otros archivos OpenSSL.</li>
<li><code>req</code>: Este subcomando se utiliza para generar una solicitud de certificados y tambi√©n solicitudes de firma de certificados (CSR).</li>
<li><code>x509</code>: Este subcomando se utiliza para firmar, cifrar, descifrar, verificar y mostrar certificados.</li>
<li><code>nodes</code>: Esto le dice a Openssl que no cifre la clave privada.</li>
<li><code>days 365</code>: Esto le dice a Openssl que el certificado expirar√° en 365 d√≠as.</li>
<li><code>newkey rsa:2048</code>: Esto le dice a Openssl que genere una nueva clave y certificado al mismo tiempo siendo, la clave RSA de 2048 bits.</li>
<li><code>keyout</code>: Esto le dice a Openssl que el archivo de clave privada se llamar√° <code>server.key</code>.</li>
<li><code>out</code>: Esto le dice a Openssl que el archivo de certificado se llamar√° <code>server.crt</code>.</li>
</ul>
<h3 id="configuracion-ssl-del-servidor-proxy-inverso">Configuraci√≥n SSL del servidor proxy inverso</h3>
<p>De la pr√°ctica anterior, dentro del directorio <code>/etc/nginx/sites-availabe</code> tenemos el archivo de configuraci√≥n "balanceo". Es aqu√≠ donde realizaremos la configuraci√≥n para que el acceso al sitio web se realice mediante SSL(HTTPS)</p>
<p>Es por esto dentro del bloque <code>server{...}</code> cambiaremos el puerto de escucha listen 80 por el siguiente bloque a continuaci√≥n.</p>
<p><img alt="'Archivo balanceo'" src="../../assets/imagenes/fotos2.5/balanceo.png" /></p>
<p>Donde estamos diciendo que:</p>
<ul>
<li>Escuche en el puerto 443 (Puerto por defecto de HTTPS).</li>
<li>El directorio donde est√° el certificado que hemos generado.</li>
<li>El directorio donde est√° la clave que hemos generado anteriormente.</li>
<li>Los protocolos y tipos de cifrados que se pueden utilizar -&gt; Estas son las versiones de protocolos y los tipos de cifrados considerados seguros a d√≠a de hoy.</li>
<li><code>server_name</code> Es el nombre del servidor.</li>
<li>Y por √∫ltimo el archivo donde se guardan los logs de acceso.</li>
</ul>
<h3 id="comprobaciones">Comprobaciones</h3>
<p><img alt="'Comprobaci√≥n 1'" src="../../assets/imagenes/fotos2.5/comprobacion1.png" /></p>
<p>Para comprobar que los datos del certificado son correctos podemos comprobarlo as√≠.</p>
<ol>
<li>
<p>Pulsamos en el candado de la barra de b√∫squeda
   <img alt="'candado'" src="../../assets/imagenes/fotos2.5/candado.png" /></p>
</li>
<li>
<p>Le damos a m√°s informaci√≥n
   <img alt="'mas_candado'" src="../../assets/imagenes/fotos2.5/mas_candado.png" /></p>
</li>
<li>
<p>Y por √∫ltimo, ver certificado:
   <img alt="'ver_certificado'" src="../../assets/imagenes/fotos2.5/ver_certificado.png" /></p>
</li>
<li>
<p>Access los</p>
</li>
<li>
<p>HTTP_ACCESS.log
<img alt="'http_access'" src="../../assets/imagenes/fotos2.5/http_access.png" /></p>
</li>
<li>
<p>HTTPS_ACCESS.log
<img alt="'https_access'" src="../../assets/imagenes/fotos2.5/https_access.png" /></p>
</li>
</ol>
<h2 id="cuestiones-finales">Cuestiones finales</h2>
<h3 id="cuestion-1">Cuesti√≥n 1</h3>
<p>-Hemos configurado nuestro proxy inverso con todo lo que nos hace falta pero no nos funciona y da un error del tipo This site can't provide a secure connection, ERR_SSL_PROTOCOL_ERROR.
Dentro de nuestro server block tenemos esto:</p>
<div class="highlight"><pre><span></span><code>server<span class="w"> </span><span class="o">{</span>
listen<span class="w"> </span><span class="m">443</span><span class="p">;</span>
ssl_certificate<span class="w"> </span>/etc/nginx/ssl/enrico-berlinguer/server.crt<span class="p">;</span>
ssl_certificate_key<span class="w"> </span>/etc/nginx/ssl/enrico-berlinguer/server.key<span class="p">;</span>
ssl_protocols<span class="w"> </span>TLSv1.3<span class="p">;</span>
ssl_ciphers<span class="w"> </span>ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS<span class="p">;</span>
server_name<span class="w"> </span>enrico-berlinguer<span class="p">;</span>
access_log<span class="w"> </span>/var/log/nginx/https_access.log<span class="p">;</span>

location<span class="w"> </span>/<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>proxy_pass<span class="w"> </span>http://red-party<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>Porque en la l√≠nea en la que pone <code>listen 443</code> no hemos a√±adido el par√°metro <code>ssl</code>. Por lo que deber√≠a ser <code>listen 443 ssl</code>. Esto significa que ahora mismo no responde peticiones HTTPS.</p>
<h3 id="cuestion-2">Cuesti√≥n 2</h3>
<p>Imaginad que intentamos acceder a nuestro sitio web HTTPS y nos encontramos con el siguiente error:</p>
<p><img alt="'error'" src="../../assets/imagenes/fotos2.5/conexion-nosegura.png" /></p>
<p>Este error ocurre porque no estamos usando un certificado de una CA de confianza, por lo que el navegador nos muestra este error. Para solucionarlo deberemos a√±adir una excepci√≥n en el navegador o a√±adir una CA de confianza.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>